import numpy as np
import threading

COLS, ROWS = 64, 41
vram = np.zeros((ROWS, COLS), dtype=np.uint16)
vram_lock = threading.Lock()

debug = False;

C0 = 0b000;  # nada
C1 = 0b001;  # arriba
C2 = 0b010;  # izquierda
C3 = 0b011;  # arriba-izquierda
C4 = 0b100;  # abajo
C5 = 0b101;  # arriba-abajo
C6 = 0b110;  # izquierda-abajo
C7 = 0b111;  # arriba-izquierda-abajo

if (debug):
    vram[2][0] = ord('A') | (C3 << 7) | (0b11 << 10)
    vram[2][1] = ord('/') | (C1 << 7) | (0b11 << 10)
    vram[2][2] = ord('N') | (C1 << 7) | (0b11 << 10)
    vram[2][3] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[3][0] = ord('P') | (C6 << 7) | (0b11 << 10)
    vram[3][1] = ord('A') | (C4 << 7) | (0b11 << 10)
    vram[3][2] = ord('G') | (C4 << 7) | (0b11 << 10)
    vram[3][3] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[2][4] = ord('L') | (C3 << 7) | (0b11 << 10)
    vram[2][5] = ord('I') | (C1 << 7) | (0b11 << 10)
    vram[2][6] = ord('N') | (C1 << 7) | (0b11 << 10)
    vram[2][7] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[3][4] = ord('U') | (C6 << 7) | (0b11 << 10)
    vram[3][5] = ord('P') | (C4 << 7) | (0b11 << 10)
    vram[3][6] = ord(' ') | (C4 << 7) | (0b11 << 10)
    vram[3][7] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[5][0] = ord(' ') | (C3 << 7) | (0b11 << 10)
    vram[5][1] = ord('S') | (C1 << 7) | (0b11 << 10)
    vram[5][2] = ord('U') | (C1 << 7) | (0b11 << 10)
    vram[5][3] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[6][0] = ord('A') | (C6 << 7) | (0b11 << 10)
    vram[6][1] = ord('I') | (C4 << 7) | (0b11 << 10)
    vram[6][2] = ord('R') | (C4 << 7) | (0b11 << 10)
    vram[6][3] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[5][4] = ord('H') | (C3 << 7) | (0b11 << 10)
    vram[5][5] = ord('L') | (C1 << 7) | (0b11 << 10)
    vram[5][6] = ord('D') | (C1 << 7) | (0b11 << 10)
    vram[5][7] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[6][4] = ord('F') | (C6 << 7) | (0b11 << 10)
    vram[6][5] = ord('R') | (C4 << 7) | (0b11 << 10)
    vram[6][6] = ord(' ') | (C4 << 7) | (0b11 << 10)
    vram[6][7] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[32][0] = ord('O') | (C3 << 7) | (0b11 << 10)
    vram[32][1] = ord('P') | (C1 << 7) | (0b11 << 10)
    vram[32][2] = ord('T') | (C1 << 7) | (0b11 << 10)
    vram[32][3] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[33][0] = ord('S') | (C6 << 7) | (0b11 << 10)
    vram[33][1] = ord('E') | (C4 << 7) | (0b11 << 10)
    vram[33][2] = ord('T') | (C4 << 7) | (0b11 << 10)
    vram[33][3] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[32][4] = ord('G') | (C3 << 7) | (0b11 << 10)
    vram[32][5] = ord('T') | (C1 << 7) | (0b11 << 10)
    vram[32][6] = ord(' ') | (C1 << 7) | (0b11 << 10)
    vram[32][7] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[33][4] = ord('A') | (C6 << 7) | (0b11 << 10)
    vram[33][5] = ord('U') | (C4 << 7) | (0b11 << 10)
    vram[33][6] = ord('T') | (C4 << 7) | (0b11 << 10)
    vram[33][7] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[35][0] = ord('R') | (C3 << 7) | (0b11 << 10)
    vram[35][1] = ord('G') | (C1 << 7) | (0b11 << 10)
    vram[35][2] = ord('S') | (C1 << 7) | (0b11 << 10)
    vram[35][3] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[36][0] = ord(' ') | (C6 << 7) | (0b11 << 10)
    vram[36][1] = ord(' ') | (C4 << 7) | (0b11 << 10)
    vram[36][2] = ord(' ') | (C4 << 7) | (0b11 << 10)
    vram[36][3] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[35][4] = ord('A') | (C3 << 7) | (0b11 << 10)
    vram[35][5] = ord('T') | (C1 << 7) | (0b11 << 10)
    vram[35][6] = ord('K') | (C1 << 7) | (0b11 << 10)
    vram[35][7] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[36][4] = ord('J') | (C6 << 7) | (0b11 << 10)
    vram[36][5] = ord('A') | (C4 << 7) | (0b11 << 10)
    vram[36][6] = ord('M') | (C4 << 7) | (0b11 << 10)
    vram[36][7] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[38][0] = ord('R') | (C3 << 7) | (0b10 << 10)
    vram[38][1] = ord('A') | (C1 << 7) | (0b10 << 10)
    vram[38][2] = ord('D') | (C1 << 7) | (0b10 << 10)
    vram[38][3] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[39][0] = ord('S') | (C6 << 7) | (0b10 << 10)
    vram[39][1] = ord('I') | (C4 << 7) | (0b10 << 10)
    vram[39][2] = ord('L') | (C4 << 7) | (0b10 << 10)
    vram[39][3] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[38][4] = ord('L') | (C3 << 7) | (0b11 << 10)
    vram[38][5] = ord('D') | (C1 << 7) | (0b11 << 10)
    vram[38][6] = ord(' ') | (C1 << 7) | (0b11 << 10)
    vram[38][7] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[39][4] = ord('R') | (C6 << 7) | (0b11 << 10)
    vram[39][5] = ord('A') | (C4 << 7) | (0b11 << 10)
    vram[39][6] = ord('D') | (C4 << 7) | (0b11 << 10)
    vram[39][7] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[38][8] = ord('R') | (C3 << 7) | (0b11 << 10)
    vram[38][9] = ord('N') | (C1 << 7) | (0b11 << 10)
    vram[38][10] = ord('G') | (C1 << 7) | (0b11 << 10)
    vram[38][11] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[39][8] = ord('G') | (C6 << 7) | (0b11 << 10)
    vram[39][9] = ord('T') | (C4 << 7) | (0b11 << 10)
    vram[39][10] = ord(' ') | (C4 << 7) | (0b11 << 10)
    vram[39][11] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[38][52] = ord('T') | (C3 << 7) | (0b11 << 10)
    vram[38][53] = ord('R') | (C1 << 7) | (0b11 << 10)
    vram[38][54] = ord('K') | (C1 << 7) | (0b11 << 10)
    vram[38][55] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[39][52] = ord('T') | (C6 << 7) | (0b11 << 10)
    vram[39][53] = ord('V') | (C4 << 7) | (0b11 << 10)
    vram[39][54] = ord('X') | (C4 << 7) | (0b11 << 10)
    vram[39][55] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[38][56] = ord('T') | (C3 << 7) | (0b11 << 10)
    vram[38][57] = ord('0') | (C1 << 7) | (0b11 << 10)
    vram[38][58] = ord(' ') | (C1 << 7) | (0b11 << 10)
    vram[38][59] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[39][56] = ord(' ') | (C6 << 7) | (0b11 << 10)
    vram[39][57] = ord('3') | (C4 << 7) | (0b11 << 10)
    vram[39][58] = ord(' ') | (C4 << 7) | (0b11 << 10)
    vram[39][59] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[38][60] = ord('S') | (C3 << 7) | (0b11 << 10)
    vram[38][61] = ord('B') | (C1 << 7) | (0b11 << 10)
    vram[38][62] = ord(' ') | (C1 << 7) | (0b11 << 10)
    vram[38][63] = ord(' ') | (C2 << 7) | (0b11 << 10)
    vram[39][60] = ord(' ') | (C6 << 7) | (0b11 << 10)
    vram[39][61] = ord(' ') | (C4 << 7) | (0b11 << 10)
    vram[39][62] = ord(' ') | (C4 << 7) | (0b11 << 10)
    vram[39][63] = ord(' ') | (C2 << 7) | (0b11 << 10)
